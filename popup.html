<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TaskHub</title>
  <link rel="stylesheet" href="popup.css">
</head>

<body>
  <div class="container">
    <header>
      <h1 class="app-title">TaskHub</h1>

      <!-- Theme Selector Modal -->
      <div id="themeModal" class="theme-modal" style="display: none;">
        <div class="theme-modal-content">
          <div class="theme-modal-header">
            <h3>Choose Your Theme</h3>
            <button id="closeThemeModal" class="theme-close-btn">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18" />
                <line x1="6" y1="6" x2="18" y2="18" />
              </svg>
            </button>
          </div>
          <div class="theme-options">
            <button class="theme-option active" data-theme="light">
              <div class="theme-preview light-preview">
                <div class="preview-header"></div>
                <div class="preview-cards">
                  <div class="preview-card"></div>
                  <div class="preview-card"></div>
                </div>
              </div>
              <span class="theme-name">Light Green</span>
              <span class="theme-description">Original calming design</span>
            </button>

            <button class="theme-option" data-theme="dark">
              <div class="theme-preview dark-preview">
                <div class="preview-header"></div>
                <div class="preview-cards">
                  <div class="preview-card"></div>
                  <div class="preview-card"></div>
                </div>
              </div>
              <span class="theme-name">Dark Mode</span>
              <span class="theme-description">Easy on the eyes</span>
            </button>

            <button class="theme-option" data-theme="minimal">
              <div class="theme-preview minimal-preview">
                <div class="preview-header"></div>
                <div class="preview-cards">
                  <div class="preview-card"></div>
                  <div class="preview-card"></div>
                </div>
              </div>
              <span class="theme-name">Minimal Blue</span>
              <span class="theme-description">Clean & professional</span>
            </button>

            <button class="theme-option" data-theme="warm">
              <div class="theme-preview warm-preview">
                <div class="preview-header"></div>
                <div class="preview-cards">
                  <div class="preview-card"></div>
                  <div class="preview-card"></div>
                </div>
              </div>
              <span class="theme-name">Warm Glow</span>
              <span class="theme-description">Cozy & energizing</span>
            </button>

            <button class="theme-option" data-theme="glass">
              <div class="theme-preview glass-preview">
                <div class="preview-header"></div>
                <div class="preview-cards">
                  <div class="preview-card"></div>
                  <div class="preview-card"></div>
                </div>
              </div>
              <span class="theme-name">Glassmorphism</span>
              <span class="theme-description">Modern & sleek</span>
            </button>
          </div>
        </div>
      </div>
    </header>

    <nav class="tabs">
      <button class="tab-btn active" data-tab="today">
        <img src="icons/check-square.svg" alt="Today" style="width: 16px; height: 16px;">
        <span>Today</span>
      </button>
      <button class="tab-btn" data-tab="summary">
        <img src="icons/file-text.svg" alt="Summary" style="width: 16px; height: 16px;">
        <span>Summary</span>
      </button>
      <button class="tab-btn" data-tab="audio">
        <img src="icons/mic.svg" alt="Audio" style="width: 16px; height: 16px;">
        <span>Audio</span>
      </button>
      <button class="tab-btn" data-tab="settings">
        <img src="icons/settings.svg" alt="Settings" style="width: 16px; height: 16px;">
        <span>Settings</span>
      </button>
    </nav>

    <div class="tab-content active" id="today">
      <div class="productivity-quote" id="productivityQuote" style="display: none;">
        <div class="quote-content">
          <div class="quote-icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18h6" />
              <path d="M10 22h4" />
              <path
                d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1.36.59 2.5 1.5 3.5.76.76 1.23 1.52 1.41 2.5" />
            </svg>
          </div>
          <p class="quote-text" id="quoteText">Loading wisdom...</p>
        </div>
        <button class="quote-close" id="closeQuote" title="Close quote">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>

      <div class="today-header">
        <h2 class="today-title">Today's Tasks</h2>
        <div class="header-actions">
          <button id="themeToggle" class="theme-toggle-btn" title="Change theme">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="4" />
              <path d="M12 2v2" />
              <path d="M12 20v2" />
              <path d="m4.93 4.93 1.41 1.41" />
              <path d="m17.66 17.66 1.41 1.41" />
              <path d="M2 12h2" />
              <path d="M20 12h2" />
              <path d="m6.34 17.66-1.41 1.41" />
              <path d="m19.07 4.93-1.41 1.41" />
            </svg>
          </button>
          <button id="moreActionsBtn" class="more-actions-btn" title="More actions">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="1"></circle>
              <circle cx="12" cy="5" r="1"></circle>
              <circle cx="12" cy="19" r="1"></circle>
            </svg>
          </button>
        </div>
        <div id="actionsDropdown" class="actions-dropdown" style="display: none;">
          <button id="manualTaskBtn" class="dropdown-item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 5v14"></path>
              <path d="M5 12h14"></path>
            </svg>
            Create Task Manually
          </button>
          <button id="captureScreenshotBtn" class="dropdown-item">
            <img src="icons/plus.svg" alt="Screenshot" style="width: 16px; height: 16px;">
            Capture from Screenshot
          </button>
          <button id="autoTaskCaptureBtn" class="dropdown-item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path
                d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z">
              </path>
              <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
              <line x1="12" y1="22.08" x2="12" y2="12"></line>
            </svg>
            Auto Capture from Page
          </button>
        </div>
      </div>

      <div class="status-nav">
        <button class="status-nav-btn active" data-status="todo">
          Todo <span class="status-count" id="todoCount">0</span>
        </button>
        <button class="status-nav-btn" data-status="in_progress">
          In Progress <span class="status-count" id="inProgressCount">0</span>
        </button>
        <button class="status-nav-btn" data-status="done">
          Done <span class="status-count" id="doneCount">0</span>
        </button>
      </div>

      <section class="section">
        <div id="taskList" class="task-list">
          <p class="empty-state">No tasks captured yet. Highlight text on any webpage to get started!</p>
        </div>
      </section>


    </div>

    <div class="tab-content" id="summary">
      <section class="section">
        <div class="summary-header">
          <h2>Daily Summary</h2>
          <button id="generateSummaryBtn" class="btn-secondary">Generate Summary</button>
        </div>
        <div id="summaryContent" class="summary-content">
          <p class="empty-state">Click "Generate Summary" to create your daily work report</p>
        </div>
        <div class="summary-actions">
          <button id="copySummaryBtn" class="btn-secondary" style="display: none;">Copy to Clipboard</button>
          <button id="exportMarkdownBtn" class="btn-secondary" style="display: none;">Export as Markdown</button>
        </div>
      </section>

      <section class="section">
        <h2>Today at a Glance</h2>
        <div id="summaryHighlights" class="summary-highlights">
          <p class="empty-state">Capture tasks to see your daily stats</p>
        </div>
      </section>

      <section class="section">
        <h2>Project Breakdown</h2>
        <div id="projectBreakdown" class="project-breakdown">
          <p class="empty-state">Project time tracking will appear here</p>
        </div>
      </section>
    </div>

    <div class="tab-content" id="audio">
      <section class="section">
        <div class="audio-mode-selector">
          <button class="mode-btn active" data-mode="quick">Quick Task</button>
          <button class="mode-btn" data-mode="meeting">Meeting</button>
        </div>

        <div class="audio-controls">
          <button id="startAudioBtn" class="btn-primary">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              style="display: inline-block; vertical-align: middle; margin-right: 6px;">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" />
              <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
              <line x1="12" y1="19" x2="12" y2="23" />
              <line x1="8" y1="23" x2="16" y2="23" />
            </svg>
            Start Recording
          </button>
          <button id="stopAudioBtn" class="btn-secondary" disabled>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              style="display: inline-block; vertical-align: middle; margin-right: 6px;">
              <rect x="6" y="4" width="12" height="16" rx="2" />
            </svg>
            Stop
          </button>
          <div id="recordingTimer" class="recording-timer">00:00</div>
        </div>

        <!-- Microphone Permission Section -->
        <div id="micPermissionSection" class="mic-permission-section" style="display: none;">
          <div class="permission-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
              <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
              <line x1="12" y1="19" x2="12" y2="23"></line>
              <line x1="8" y1="23" x2="16" y2="23"></line>
            </svg>
          </div>
          <h3 style="margin: 16px 0 8px;">Microphone Permission Required</h3>
          <p style="color: #666; margin-bottom: 16px; line-height: 1.5;">
            To use voice recording, please enable microphone access in Chrome settings.
          </p>
          <button id="openChromeSettings" class="btn-primary" style="width: 100%; margin-bottom: 12px;">
            Open Chrome Settings
          </button>
          <div class="permission-instructions">
            <p style="font-size: 12px; color: #888; margin: 8px 0;">Instructions:</p>
            <ol style="font-size: 11px; color: #666; padding-left: 20px; margin: 0; text-align: left;">
              <li>Click the button above to open settings</li>
              <li>Find "TaskHub" in the list</li>
              <li>Click "Site settings"</li>
              <li>Find "Microphone" and set to "Allow"</li>
              <li>Close settings and try recording again</li>
            </ol>
          </div>
        </div>

        <div id="liveTranscript" class="transcript-box">
          <p class="empty-state">Click "Start Recording" to begin speaking.</p>
          <p class="privacy-note">Speech-to-text â†’ AI task extraction - nothing stored</p>
        </div>

        <div id="audioTasksPreview" class="tasks-preview"></div>

        <div class="audio-actions">
          <button id="saveAudioTasksBtn" class="btn-primary" disabled>Save Tasks</button>
          <button id="copyMeetingSummaryBtn" class="btn-secondary" disabled>Copy Summary</button>
          <button id="cancelAudioBtn" class="btn-secondary" disabled>Cancel</button>
        </div>
      </section>
    </div>

    <div class="tab-content" id="settings">
      <!-- Google Account Card -->
      <div class="settings-card">
        <h2>Google Account</h2>
        <div id="googleAuthSection">
          <div id="signedOutView" style="display: none;">
            <button id="googleSignInBtn" class="btn-primary" style="width: 100%; margin-top: 12px;">Sign In with
              Google</button>
          </div>
          <div id="signedInView" style="display: none;">
            <p class="info-text" style="margin-bottom: 12px;">Signed in as: <strong id="googleEmail"></strong></p>
            <button id="googleSignOutBtn" class="btn-secondary" style="width: 100%;">Sign Out</button>
          </div>
          <p id="googleAuthStatus" class="status-text">Checking Google account status...</p>
        </div>
      </div>

      <!-- Google Sync Card -->
      <div class="settings-card">
        <div class="toggle-container">
          <div>
            <h2 style="margin: 0;">Google Sync</h2>
          </div>
          <div class="toggle-switch" id="toggleGoogleSync"></div>
        </div>
        <input type="checkbox" id="googleSyncEnabled" checked style="display: none;">
      </div>

      <!-- Work Settings Card -->
      <div class="settings-card">
        <h2 style="margin: 0 0 12px 0;">Work Settings</h2>
        <div style="display: grid; gap: 12px;">
          <div>
            <label for="defaultDuration"
              style="display: block; font-size: 12px; color: #2C3E2F; margin-bottom: 6px; font-weight: 500;">Default
              Task Duration (minutes)</label>
            <input type="number" id="defaultDuration" min="5" max="480" step="5" value="30"
              style="width: 100%; padding: 10px; border: 1px solid rgba(136, 171, 142, 0.3); border-radius: 8px; background: white; font-size: 13px;">
          </div>
          <div>
            <label for="productiveHours"
              style="display: block; font-size: 12px; color: #2C3E2F; margin-bottom: 6px; font-weight: 500;">Target
              Productive Hours per Day</label>
            <input type="number" id="productiveHours" min="1" max="24" step="0.5" value="8"
              style="width: 100%; padding: 10px; border: 1px solid rgba(136, 171, 142, 0.3); border-radius: 8px; background: white; font-size: 13px;">
          </div>
          <div>
            <label for="workStartTime"
              style="display: block; font-size: 12px; color: #2C3E2F; margin-bottom: 6px; font-weight: 500;">Work Start
              Time</label>
            <input type="time" id="workStartTime" value="09:00"
              style="width: 100%; padding: 10px; border: 1px solid rgba(136, 171, 142, 0.3); border-radius: 8px; background: white; font-size: 13px;">
          </div>
        </div>
      </div>

      <!-- AI Features Card -->
      <div class="settings-card">
        <div class="toggle-container">
          <div>
            <h2 style="margin: 0;">AI Features</h2>
            <p class="toggle-description" id="aiStatusText">Active</p>
          </div>
          <div class="toggle-switch active" id="toggleAI"></div>
        </div>
        <input type="checkbox" id="aiEnabled" checked style="display: none;">
        <div class="ai-status" id="aiStatus" style="margin-top: 12px;">
          <p>Checking Chrome AI availability...</p>
        </div>
      </div>

      <!-- Translation Card -->
      <div class="settings-card">
        <div class="toggle-container">
          <div>
            <h2 style="margin: 0;">Translation</h2>
          </div>
          <div class="toggle-switch" id="toggleTranslation"></div>
        </div>
        <input type="checkbox" id="translationEnabled" style="display: none;">
        <div id="translationLanguageSection" style="margin-top: 12px; display: none;">
          <label for="translationLanguage"
            style="display: block; font-size: 12px; color: #2C3E2F; margin-bottom: 6px;">Translate to:</label>
          <select id="translationLanguage" class="translation-language-select"
            style="width: 100%; padding: 10px; border: 1px solid rgba(136, 171, 142, 0.3); border-radius: 8px; background: white; font-size: 13px;">
            <option value="en">English</option>
            <option value="es">Spanish</option>
            <option value="fr">French</option>
            <option value="de">German</option>
            <option value="it">Italian</option>
            <option value="pt">Portuguese</option>
            <option value="ru">Russian</option>
            <option value="ja">Japanese</option>
            <option value="ko">Korean</option>
            <option value="zh">Chinese</option>
            <option value="ar">Arabic</option>
            <option value="hi">Hindi</option>
          </select>
        </div>
      </div>

      <!-- Danger Zone Card -->
      <div class="settings-card">
        <h2 style="margin: 0 0 12px 0;">Danger Zone</h2>
        <button id="clearDataBtn" class="btn-danger" style="width: 100%;">Clear All Data</button>
      </div>
    </div>
  </div>

  <!-- Manual Task Modal -->
  <div id="manualTaskModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Create Manual Task</h3>
        <button id="closeManualTaskModal" class="modal-close-btn" title="Close">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18" />
            <line x1="6" y1="6" x2="18" y2="18" />
          </svg>
        </button>
      </div>
      <form id="manualTaskForm" class="modal-body">
        <div class="form-group">
          <label for="manualTaskTitle">Task</label>
          <input type="text" id="manualTaskTitle" name="task" placeholder="What needs to get done?" required maxlength="120">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="manualTaskPriority">Priority</label>
            <select id="manualTaskPriority" name="priority">
              <option value="low">Low</option>
              <option value="medium" selected>Medium</option>
              <option value="high">High</option>
            </select>
          </div>
          <div class="form-group">
            <label for="manualTaskDuration">Duration (min)</label>
            <input type="number" id="manualTaskDuration" name="estimatedDuration" min="5" max="480" step="5" required>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="manualTaskProject">Project</label>
            <input type="text" id="manualTaskProject" name="project" placeholder="Project name">
          </div>
          <div class="form-group">
            <label for="manualTaskDeadline">Deadline</label>
            <input type="date" id="manualTaskDeadline" name="deadline">
          </div>
        </div>
        <div class="form-group">
          <label for="manualTaskTags">Tags (comma separated)</label>
          <input type="text" id="manualTaskTags" name="tags" placeholder="planning, follow-up">
        </div>
        <div id="manualTaskError" class="form-error" style="display: none;"></div>
        <div class="modal-footer">
          <button type="button" id="cancelManualTask" class="btn-secondary">Cancel</button>
          <button type="submit" class="btn-primary">Save Task</button>
        </div>
      </form>
    </div>
  </div>

  <script src="popup.js" type="module"></script>
</body>

</html>
